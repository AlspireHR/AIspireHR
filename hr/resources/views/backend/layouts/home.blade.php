@extends('backend.layouts.app')
@section('title', localize('dashboard'))
@push('css')
    <link href="{{ asset('backend/assets/custom.css') }}" rel="stylesheet">
    <link href="{{ asset('backend/assets/plugins/apexcharts/dist/apexcharts.css') }}" rel="stylesheet">
@endpush
@section('content')
    @include('backend.layouts.common.message')

    <div class="tab-content" id="pills-tabContent">
        <div id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
            <div class="row g-4">
                <div class="col-lg-5 col-xl-3 col-xxl-2">
                    <div class="d-flex gap-3 flex-column justify-content-between h-100">
                        <div class="card justify-content-center h-100 p-4 rounded-15">
                            <div class="d-flex gap-2 align-items-center justify-content-between">
                                <div>
                                    <p class="fs-16 fw-medium mb-1">
                                        {{ localize('total_employee') }}
                                    </p>
                                    <h3 class="mb-0 fw-bold">
                                        {{ $total_employee }}
                                    </h3>
                                </div>
                                <div class="bg-soft-success p-2 rounded-3">
                                    <svg width="26" height="20" viewBox="0 0 26 20" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M19.4102 9.23327C20.6623 8.28328 21.4682 6.82078 21.4682 5.1749C21.4682 2.32078 19.0463 0 16.0741 0C14.5794 0 13.2275 0.587489 12.2484 1.52916C11.4382 1.0625 10.5067 0.808341 9.55352 0.808341C6.68111 0.808341 4.34136 3.04582 4.34136 5.79177C4.34136 7.35011 5.09958 8.74589 6.27805 9.66268C4.98259 10.1127 3.79112 10.821 2.7859 11.7835C0.992187 13.5085 0 15.8 0 18.2458C0 19.2125 0.818855 20 1.82837 20H24.1283C25.1595 20 26 19.1917 26 18.2C25.9957 14.071 23.2447 10.5458 19.4102 9.23327ZM16.0742 1.66666C18.0931 1.66666 19.7352 3.24163 19.7352 5.1749C19.7352 7.10817 18.0931 8.68314 16.0742 8.68314C14.0552 8.68314 12.4131 7.10817 12.4131 5.1749C12.4131 3.24163 14.0552 1.66666 16.0742 1.66666ZM6.07882 5.79169C6.07882 3.96253 7.63855 2.47492 9.55793 2.47492C10.1515 2.47492 10.7277 2.62075 11.239 2.89158C10.8837 3.57907 10.6801 4.35408 10.6801 5.1749C10.6801 6.35822 11.1003 7.44987 11.8022 8.32474C11.1913 8.82474 10.4115 9.10807 9.59259 9.11223H9.5276C7.62558 9.09973 6.07882 7.60832 6.07882 5.79169ZM1.82857 18.3332C1.77658 18.3332 1.73325 18.2957 1.73325 18.2457C1.73325 16.2499 2.54345 14.3748 4.01654 12.9665C5.4853 11.5582 7.44352 10.7791 9.52317 10.7791H9.59249C9.67915 10.7791 9.7658 10.7874 9.85245 10.7874C7.5995 12.5332 6.15234 15.2082 6.15234 18.1999C6.15234 18.2457 6.161 18.2874 6.16534 18.3332L1.82857 18.3332ZM24.1241 18.3332H8.02426C7.9506 18.3332 7.88561 18.2749 7.88561 18.1999C7.88561 13.8708 11.5466 10.3498 16.0484 10.3498H16.1004C20.6018 10.3498 24.2631 13.8706 24.2631 18.1999C24.2631 18.2749 24.2025 18.3332 24.1245 18.3332H24.1241Z"
                                            fill="#00B074" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="card justify-content-center h-100 p-4 rounded-15">
                            <div class="d-flex gap-2 align-items-center justify-content-between">
                                <div>
                                    <p class="fs-16 fw-medium mb-1">
                                        {{ localize('today_presents') }}
                                    </p>
                                    <h3 class="mb-0 fw-bold">
                                        {{ bt_number_format($present_employee) }}
                                    </h3>
                                </div>
                                <div class="bg-soft-success p-2 rounded-3">
                                    <svg width="26" height="24" viewBox="0 0 26 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M5.26239 13.1559C5.26233 14.3654 5.45188 15.5629 5.82021 16.6803C6.18854 17.7977 6.72843 18.813 7.40907 19.6682C8.08971 20.5234 8.89775 21.2018 9.78706 21.6646C10.6764 22.1274 11.6295 22.3657 12.5921 22.3657C13.5547 22.3657 14.5079 22.1274 15.3972 21.6646C16.2865 21.2018 17.0946 20.5234 17.7752 19.6682C18.4558 18.813 18.9957 17.7977 19.3641 16.6803C19.7324 15.5629 19.9219 14.3654 19.9219 13.1559C19.9219 11.9465 19.7324 10.749 19.3641 9.63158C18.9957 8.51421 18.4558 7.49893 17.7752 6.64372C17.0946 5.78852 16.2865 5.11012 15.3972 4.64729C14.5079 4.18445 13.5547 3.94623 12.5921 3.94623C11.6295 3.94623 10.6764 4.18445 9.78706 4.64729C8.89775 5.11012 8.08971 5.78852 7.40907 6.64372C6.72843 7.49893 6.18854 8.51421 5.82021 9.63158C5.45188 10.749 5.26233 11.9465 5.26239 13.1559Z"
                                            fill="#099B69" fill-opacity="0.15" />
                                        <path
                                            d="M0.563827 12.5921C0.187942 12.5921 0 12.2162 0 11.8404C0 10.9007 0.375884 8.83329 1.69148 6.57798C1.87942 6.20209 2.25531 6.20209 2.63119 6.39004C3.00708 6.57798 3.19502 7.14181 2.81913 7.32975C1.69148 9.58505 1.3156 11.2765 1.3156 12.0283C1.3156 12.4042 0.939711 12.5921 0.563827 12.5921ZM3.19502 6.39004C3.00708 6.39004 2.81913 6.39004 2.81913 6.20209C2.44325 6.01415 2.44325 5.45033 2.63119 5.26238C3.94679 3.5709 5.63827 2.25531 7.32975 1.3156C7.70563 1.12765 8.08152 1.3156 8.26946 1.69148C8.4574 2.06736 8.26946 2.44325 7.89357 2.63119C6.39004 3.38296 5.07444 4.51061 3.75885 6.01415C3.75885 6.20209 3.5709 6.39004 3.19502 6.39004ZM9.96094 1.87942C9.58506 1.87942 9.39711 1.69148 9.20917 1.3156C9.20917 0.939711 9.39711 0.563827 9.773 0.375884C10.9007 0 12.2162 0 13.5318 0C14.0957 0.187942 14.2836 0.563827 14.2836 0.939711C14.2836 1.3156 13.9077 1.69148 13.5318 1.69148C12.4042 1.50354 11.2765 1.50354 9.96094 1.87942C10.1489 1.87942 10.1489 1.87942 9.96094 1.87942ZM18.9822 3.19502C18.7942 3.19502 18.7942 3.19502 18.6063 3.00708C17.4786 2.25531 16.163 1.87942 14.8474 1.50354C14.6595 1.69148 14.2836 1.3156 14.4716 0.939711C14.4716 0.563827 14.8474 0.375884 15.2233 0.375884C16.7269 0.751769 18.0425 1.12765 19.3581 2.06736C19.7339 2.25531 19.7339 2.63119 19.546 3.00708C19.546 3.19502 19.1701 3.19502 18.9822 3.19502ZM24.6204 14.4716C24.2446 14.4716 23.8687 14.0957 23.8687 13.7198C23.6807 9.58506 22.3651 6.39004 20.1098 4.32267C19.7339 4.13473 19.7339 3.5709 20.1098 3.38296C20.2978 3.00708 20.8616 3.00708 21.0495 3.38296C23.4928 5.63827 24.9963 9.20917 25.1843 13.7198C25.3722 14.0957 24.9963 14.4716 24.6204 14.4716Z"
                                            fill="#00B074" />
                                        <path
                                            d="M20.2978 22.5531H20.1098C19.7339 22.3651 19.546 21.9893 19.7339 21.6134C19.7339 21.6134 20.1098 20.4857 20.6736 18.2304C21.2375 15.9751 20.8616 12.968 20.8616 12.968C20.8616 9.77301 18.9822 6.76593 15.9751 5.45034C15.5992 5.26239 15.4113 4.88651 15.5992 4.51062C15.7871 4.13474 16.163 3.9468 16.5389 4.13474C19.9219 5.63828 22.1772 9.02124 22.1772 12.7801C22.1772 12.7801 22.5531 15.9751 21.9892 18.4183C21.4254 20.8616 20.8616 21.9893 20.8616 21.9893C20.6736 22.3651 20.4857 22.5531 20.2978 22.5531ZM7.70563 6.2021C7.51769 6.2021 7.32975 6.01416 7.1418 5.82622C6.95386 5.63828 7.1418 5.26239 7.32975 5.07445C9.39711 3.57091 11.8404 3.00709 14.2836 3.57091C14.6595 3.57091 14.8474 3.9468 14.8474 4.32268C14.8474 4.69857 14.4716 4.88651 14.0957 4.88651C12.0283 4.51062 9.96094 4.88651 8.26946 6.2021H7.70563ZM0.751769 16.9148C0.375884 16.9148 0.187942 16.7269 0 16.351C0 15.9751 0.187942 15.5992 0.563827 15.5992C0.563827 15.5992 1.3156 15.4113 2.06736 14.6595C2.63119 14.0957 3.19502 13.156 3.38296 12.7801C3.38296 10.7127 4.13473 8.64535 5.45032 6.95387C5.63827 6.57799 6.20209 6.39005 6.39004 6.76593C6.76592 6.95387 6.76592 7.32976 6.57798 7.70564C5.45032 9.20918 4.69856 10.9007 4.69856 12.7801V12.968C4.69856 13.156 4.13473 14.8474 3.00708 15.5992C1.87942 16.5389 0.939711 16.9148 0.939711 16.9148H0.751769Z"
                                            fill="#00B074" />
                                        <path
                                            d="M2.2553 19.3581C2.06736 19.3581 1.87942 19.1701 1.69147 18.9822C1.50353 18.6063 1.50353 18.2304 1.87942 18.0425C1.87942 18.0425 4.32267 16.351 5.07443 15.7872C5.26238 15.5992 5.8262 14.6595 6.01415 13.7198C6.01415 12.2163 6.95386 9.58508 7.89357 8.45743C7.89357 8.45743 8.26945 7.8936 9.20917 7.32977C9.96093 6.95389 10.9006 6.578 11.8404 6.578C12.2162 6.39006 12.5921 6.578 12.5921 6.95389C12.5921 7.32977 12.4042 7.70566 12.0283 7.70566C11.2765 7.70566 10.7127 7.8936 10.1489 8.26948C9.39711 8.83331 9.02122 9.20919 9.02122 9.20919C8.26945 10.1489 7.32974 12.5922 7.32974 13.9078V14.0957C7.1418 14.6595 6.57797 16.351 5.8262 17.1028C5.26238 17.4787 2.81913 19.1701 2.63119 19.3581H2.2553ZM17.1027 10.3368C16.9148 10.3368 16.7269 10.3368 16.5389 10.1489C15.9751 9.20919 15.0354 8.45743 13.9077 8.08154C13.5318 7.8936 13.3439 7.51771 13.5318 7.14183C13.5318 6.76594 14.0957 6.578 14.4715 6.76594C15.7871 7.32977 17.1027 8.26948 17.8545 9.20919C18.0425 9.58508 18.0424 9.96096 17.6666 10.1489C17.4786 10.3368 17.2907 10.3368 17.1027 10.3368ZM17.6666 17.4787C17.1027 17.2907 16.9148 16.9148 16.9148 16.5389C17.1027 15.9751 17.1027 15.5992 17.2907 15.4113C17.4786 14.6595 17.4786 12.968 17.4786 12.968C17.4786 12.5922 17.4786 12.0283 17.2907 11.6524C17.2907 11.2766 17.4786 10.9007 17.8545 10.7127C18.2304 10.5248 18.6063 10.9007 18.7942 11.2766C18.9822 11.8404 18.9822 12.4042 18.9822 12.968C18.9822 12.968 18.7942 14.8475 18.7942 15.5992C18.7942 15.7872 18.6063 16.1631 18.6063 16.7269C18.2304 17.1028 18.0424 17.4787 17.6666 17.4787Z"
                                            fill="#00B074" />
                                        <path
                                            d="M16.163 22.929H15.9751C15.5992 22.741 15.4113 22.3651 15.5992 21.9893C15.5992 21.9893 16.163 19.9219 16.7269 18.0425C16.7269 17.6666 17.2907 17.4786 17.6666 17.4786C18.0425 17.4786 18.2304 17.8545 18.2304 18.4183C17.8545 20.2978 17.1028 22.3651 17.1028 22.3651C16.7269 22.741 16.5389 22.929 16.163 22.929Z"
                                            fill="#00B074" />
                                        <path
                                            d="M13.156 23.1169C12.5921 22.929 12.4042 22.5531 12.4042 22.1772L14.4716 13.7198C14.8474 12.5921 14.0957 11.4645 12.968 11.0886C11.8404 10.9006 10.5248 11.6524 10.3368 12.7801L8.4574 18.2304L4.69855 21.2375C4.32267 21.6134 3.75884 21.6134 3.5709 21.2375C3.38296 20.8616 3.38296 20.4857 3.75884 20.2978L7.32974 17.4786L9.02122 12.5921C9.02122 11.6524 9.77299 10.7127 10.5248 10.3368C11.2765 9.773 12.4042 9.58505 13.3439 9.96094C15.2233 10.3368 16.5389 12.2162 15.9751 14.2836L13.9077 22.741C13.9077 22.929 13.5318 23.1169 13.156 23.1169Z"
                                            fill="#00B074" />
                                        <path
                                            d="M9.02123 23.3049H8.64535C8.26946 23.1169 8.26946 22.741 8.4574 22.3651L10.5248 18.6063L11.6524 13.3439C11.6524 12.968 12.0283 12.7801 12.4042 12.7801C12.7801 12.7801 12.968 13.156 12.968 13.5319L11.8404 19.1701L9.58506 23.1169C9.58506 23.1169 9.20917 23.3049 9.02123 23.3049Z"
                                            fill="#00B074" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="card justify-content-center h-100 p-4 rounded-15">
                            <div class="d-flex gap-2 align-items-center justify-content-between">
                                <div>
                                    <p class="fs-16 fw-medium mb-1">
                                        {{ localize('today_absents') }}
                                    </p>
                                    @php
                                        $prandleave =
                                            (!empty($present_employee) ? $present_employee : 0) +
                                            (!empty($today_leave) ? $today_leave : 0);
                                        $today_absents = $total_employee - $prandleave;
                                    @endphp
                                    <h3 class="mb-0 fw-bold">
                                        {{ number_format($today_absents) }}
                                    </h3>
                                </div>
                                <div class="bg-soft-success p-2 rounded-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="22"
                                        viewBox="0 0 640 512">
                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                            d="M96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM0 482.3C0 383.8 79.8 304 178.3 304h91.4C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7H29.7C13.3 512 0 498.7 0 482.3zM471 143c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"
                                            fill="#00B074" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="card justify-content-center h-100 p-4 rounded-15">
                            <div class="d-flex gap-2 align-items-center justify-content-between">
                                <div>
                                    <p class="fs-16 fw-medium mb-1">
                                        {{ localize('today_leave') }}
                                    </p>
                                    <h3 class="mb-0 fw-bold">
                                        {{ number_format($today_leave) }}
                                    </h3>
                                </div>
                                <div class="bg-soft-success p-2 rounded-3">
                                    <svg width="26" height="22" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 448 512">
                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                            d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z"
                                            fill="#00B074" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-7 col-xl-5 col-xxl-6">
                    <div class="card h-100 rounded-15">
                        <div class="card-header d-flex pb-2 align-items-center justify-content-between">
                            <h5 class="m-0 fs-18 fw-semi-bold">
                                {{ localize('Daily Attendance statistic (Department wise)') }}
                            </h5>
                        </div>
                        <div class="card-body pt-2">
                            <div id="attendance"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5 col-xl-4">
                    <div class="card h-100 rounded-15">
                        <div class="card-header align-items-center">
                            <h5 class="m-0 fs-18 fw-semi-bold text-color-1">
                                Leave Application
                            </h5>
                        </div>
                        <div class="card-body p-0">
                            @foreach ($leaveEmployees as $leave)
                                <div class="d-flex justify-content-between align-items-center border-bottom px-4 py-3">
                                    <div class="d-flex align-items-start gap-3">
                                        <img class="rounded-3 dashboard-user-img" src="./assets/user-1.png"
                                            alt="" />
                                        <div>
                                            <p class="mb-2 lh-1 fs-18 fw-semi-bold text-color-1">
                                                {{ $leave->employee?->full_name }}
                                            </p>
                                            <p class="mb-2 lh-1 fs-14 fw-normal">
                                                {{ $leave->employee?->position?->position_name }}
                                            </p>
                                            <p class="mb-0 lh-1 fs-14 fw-medium">
                                                {{ localize('reason') }} : {{ Str::limit($leave->reason, 20) }}
                                            </p>
                                        </div>
                                    </div>
                                    <div
                                        class="bg-soft-{{ $leave->is_approved ? 'success' : 'warning' }} w-px-90 rounded-3 p-1">
                                        <p
                                            class="mb-0 fs-14 fw-semi-bold text-color-{{ $leave->is_approved ? '3' : '2' }} text-center">
                                            {{ $leave->is_approved ? 'Approved' : 'Pending' }}
                                        </p>
                                    </div>
                                </div>
                            @endforeach
                            <div class="py-3">
                                <a href="{{ route('leave.index') }}"
                                    class="d-flex gap-1 align-items-center justify-content-center lh-lg fs-14 fw-semi-bold text-color-3">
                                    See All Request
                                    <svg width="11" height="8" viewBox="0 0 11 8" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 4H10M10 4L6.75 1M10 4L6.75 7" stroke="#00B074" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
             

            </div>
        </div>
    </div>
    <input type="hidden" id="departmentWiseAttendanceReport"
        value="{{ json_encode($departmentWiseAttendanceReport) }}" />
    <input type="hidden" id="positionWiseRecruitmentUrl" value="{{ route('positionWiseRecruitment', '') }}" />
    <input type="hidden" id="departmentWiseAttendanceUrl" value="{{ route('departmentWiseAttendance', '') }}" />
@endsection

@push('js')
    <script src="{{ asset('backend/assets/plugins/apexcharts/dist/apexcharts.js') }}"></script>
    <script src="{{ asset('backend/assets/dist/js/dashboardChart.js?v=1') }}"></script>
@endpush
